(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{266:function(e,t,a){"use strict";a.r(t);var s=a(55),n=a.n(s),i=a(4),r=a.n(i),o=a(6),u=a(1),l={data:function(){return{isEditStatus:!1,userInfo:{},rules:{username:[{required:!0,trigger:"blur",message:"请输入用户名"}],email:[{required:!0,trigger:"blur",message:"请输入邮箱"},{trigger:"blur",validator:function(e,t,a){t=t.trim();/^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/.test(t)?a():a(new Error("请输入正确的邮箱地址"))}}]},inputStatus:{usernameDisabled:!0,infoDisabled:!0}}},computed:r()({},Object(o.d)(["isMiniWidth","user"])),asyncData:function(e){var t=e.store;e.route;return t.dispatch("getUserInfo")},mounted:function(){this.getUserInfo()},methods:r()({},Object(o.c)({setUserInfo:u.i}),Object(o.b)(["getUserInfo"]),{handleSuccess:function(e){this.$set(this.user,"avatar",e.data.path+"?v="+(new Date).getTime()),this.setUserInfo(this.user),this.$notify.success("上传成功")},beforeAvatarUpload:function(e){var t="image/jpeg"===e.type,a="image/png"===e.type,s=e.size/1024<300;return t||a||this.$message.error("上传头像图片只能是 JPG或者PNG 格式!"),s||this.$message.error("上传头像图片大小不能超过 300KB!"),(t||a)&&s},toggleEditStatus:function(){this.isEditStatus=!this.isEditStatus},save:function(){var e=this;this.$refs.form.validate(function(t){t&&e.updateUserInfo().then(function(t){e.setUserInfo(n()(e.userInfo,t)),e.resetStatus()})})},updateUserInfo:function(){return this.$http({url:"/user",method:"put",data:{info:this.userInfo.info,username:this.userInfo.username,email:this.userInfo.email},showErrorMsg:!0,showSuccessMsg:!0}).xhrInstance},resetStatus:function(){this.isEditStatus=!1}}),watch:{user:{deep:!0,handler:function(e,t){this.userInfo=e.baseInfo||{}}}}},f=(a(527),a(9)),p=Object(f.a)(l,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"author-info-page"},[a("div",{staticClass:"user-info-panel"},[a("el-form",{ref:"form",attrs:{rules:e.rules,model:e.userInfo,"label-width":"80px","label-position":"left"}},[a("el-form-item",{attrs:{label:"头像",prop:"url"}},[a("img",{staticClass:"user-avatar avatar-left",attrs:{src:e.userInfo.avatar,alt:""}}),e._v(" "),a("div",{staticClass:"avatar-right"},[a("el-upload",{ref:"upload",staticClass:"upload-avatar-input",attrs:{action:e.$globalConfig.SERVER_ADDRESS+"/user/avatar/","list-type":"text","with-credentials":!0,"show-file-list":!1,"before-upload":e.beforeAvatarUpload,"on-success":e.handleSuccess}},[a("p",{staticClass:"support-desc"},[e._v("支持 jpg、png 格式大小 5M 以内的图片")]),e._v(" "),a("el-button",{staticClass:"upload-avatar-btn",attrs:{size:"small"}},[e._v("点击上传")])],1)],1)]),e._v(" "),a("el-form-item",{staticClass:"username-input-item",attrs:{label:"用户名",prop:"username"}},[e.isEditStatus?a("el-input",{model:{value:e.userInfo.username,callback:function(t){e.$set(e.userInfo,"username",t)},expression:"userInfo.username"}}):a("p",[e._v(e._s(e.user.baseInfo.username))])],1),e._v(" "),a("el-form-item",{staticClass:"username-input-item",attrs:{label:"用户邮箱",prop:"email"}},[e.isEditStatus?a("el-input",{model:{value:e.userInfo.email,callback:function(t){e.$set(e.userInfo,"email",t)},expression:"userInfo.email"}}):a("p",[e._v(e._s(e.user.baseInfo.email))])],1),e._v(" "),a("el-form-item",{staticClass:"user-info-input-item",attrs:{label:"个人介绍"}},[e.isEditStatus?a("el-input",{attrs:{type:"textarea",rows:6},model:{value:e.userInfo.info,callback:function(t){e.$set(e.userInfo,"info",t)},expression:"userInfo.info"}}):a("p",[e._v(e._s(e.user.baseInfo.info))])],1),e._v(" "),a("el-form-item",{attrs:{label:""}},[a("el-button",{attrs:{type:"default",size:"small",plain:""},on:{click:e.toggleEditStatus}},[e._v(e._s(e.isEditStatus?"取消":"编辑"))]),e._v(" "),a("el-button",{attrs:{type:"success",size:"small",plain:""},on:{click:e.save}},[e._v("保存")])],1)],1)],1)])},[],!1,null,"9258803c",null);t.default=p.exports},286:function(e,t,a){var s=a(528);"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);(0,a(3).default)("52e510f6",s,!0,{})},527:function(e,t,a){"use strict";var s=a(286);a.n(s).a},528:function(e,t,a){(e.exports=a(2)(!1)).push([e.i,".author-info-page .user-info-panel[data-v-9258803c] {\n  padding: 20px;\n  box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1);\n}\n.author-info-page .user-info-panel[data-v-9258803c] .el-upload {\n  text-align: left;\n}\n.author-info-page .user-info-panel .avatar-left[data-v-9258803c],\n.author-info-page .user-info-panel .avatar-right[data-v-9258803c] {\n  display: inline-block;\n  vertical-align: middle;\n}\n.author-info-page .user-info-panel .avatar-left[data-v-9258803c] {\n  margin-right: 20px;\n}\n.author-info-page .user-info-panel .user-avatar[data-v-9258803c] {\n  width: 80px;\n  height: 80px;\n  border: 1px solid #e5e5e5;\n}\n.author-info-page .user-info-panel .avatar-right .support-desc[data-v-9258803c] {\n  line-height: 1.5;\n  color: #909090;\n  font-size: 12px;\n}\n.author-info-page .user-info-panel .username-input-item[data-v-9258803c] .el-input {\n  width: 80%;\n}\n.author-info-page .user-info-panel .user-info-input-item[data-v-9258803c] .el-textarea {\n  width: 80%;\n}\n.author-info-page .user-info-panel .user-info-input-item[data-v-9258803c] .el-textarea textarea {\n  font-family: 'Arial';\n}\n",""])}}]);