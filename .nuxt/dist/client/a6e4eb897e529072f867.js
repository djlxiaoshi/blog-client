(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{456:function(t,e,r){var content=r(680);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(21).default)("e8187a20",content,!0,{sourceMap:!1})},679:function(t,e,r){"use strict";var n=r(456);r.n(n).a},680:function(t,e,r){(e=r(20)(!1)).push([t.i,".author-info-page[data-v-242ba87d]{padding:20px}.author-info-page[data-v-242ba87d] .el-upload{text-align:left}.author-info-page .avatar-image[data-v-242ba87d]{width:100px;height:100px;border:1px solid #e5e5e5}.author-info-page .error-slot[data-v-242ba87d]{height:100%;display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;-webkit-box-pack:center;justify-content:center}.author-info-page[data-v-242ba87d] .el-form-item{margin-bottom:15px}.author-info-page[data-v-242ba87d] .el-form-item__label{padding-bottom:0;font-weight:700}",""]),t.exports=e},706:function(t,e,r){"use strict";r.r(e);r(42),r(24),r(22),r(18),r(37);var n=r(14),o=r(19),l=r(74),f=r.n(l);function c(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}function d(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(e){Object(n.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var m={head:{title:"用户信息",titleTemplate:"%s - DJL箫氏的博客!",htmlAttrs:{lang:"en",amp:!0},meta:[{hid:"description",name:"description",content:"用户信息页面"}]},components:{AppLoading:r(89).a},data:function(){return{isEditStatus:!1,rules:{username:[{required:!0,trigger:"blur",message:"请输入用户名"}],email:[{required:!0,trigger:"blur",message:"请输入邮箱"},{trigger:"blur",validator:function(t,e,r){e=e.trim();/^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/.test(e)?r():r(new Error("请输入正确的邮箱地址"))}}]},inputStatus:{usernameDisabled:!0,infoDisabled:!0},baseInfo:{}}},computed:d({},Object(o.d)({userInfo:function(t){return t.user.userInfo}}),{avatar:function(){return this.userInfo?"".concat(this.$globalConfig.IMAGE_ADDRESS,"/").concat(this.userInfo.avatarKey,"?v=").concat((new Date).getTime()):f.a}}),asyncData:function(t){var e=t.store;t.route;return e.dispatch("user/getUserInfo")},mounted:function(){this.baseInfo=JSON.parse(JSON.stringify(this.userInfo))},methods:d({},Object(o.c)({setUserInfo:"user/setUserInfo"}),{},Object(o.b)({getUserInfo:"user/getUserInfo"}),{handleSuccess:function(t){this.$set(this.userInfo,"avatarKey",t.data.avatarKey),this.setUserInfo(JSON.parse(JSON.stringify(this.userInfo))),this.$notify.success("上传成功")},beforeAvatarUpload:function(t){var e="image/jpeg"===t.type,r="image/png"===t.type,n=t.size/1024<300;return e||r||this.$notify.error("上传头像图片只能是 JPG或者PNG 格式!"),n||this.$notify.error("上传头像图片大小不能超过 300KB!"),(e||r)&&n},toggleEditStatus:function(){this.isEditStatus=!this.isEditStatus},save:function(){var t=this;this.$refs.form.validate((function(e){e&&t.updateUserInfo().then((function(e){t.setUserInfo(Object.assign({},t.userInfo,e)),t.resetStatus()}))}))},updateUserInfo:function(){return this.$http({url:"/user",method:"put",data:{info:this.baseInfo.info,username:this.baseInfo.username,email:this.baseInfo.email},showErrorMsg:!0,showSuccessMsg:!0}).response},resetStatus:function(){this.isEditStatus=!1}})},h=(r(679),r(11)),component=Object(h.a)(m,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"author-info-page"},[r("el-row",{attrs:{type:"flex"}},[r("el-col",{attrs:{xs:24,sm:24,md:24,lg:24,xl:24}},[r("el-form",{ref:"form",attrs:{rules:t.rules,model:t.userInfo,"label-width":"80px","label-position":"top"}},[r("el-form-item",{attrs:{label:"头像",prop:"url"}},[r("el-upload",{ref:"upload",staticClass:"upload-avatar-input",attrs:{action:t.$globalConfig.SERVER_ADDRESS+"/api/user/avatar/test","with-credentials":!0,"show-file-list":!1,"before-upload":t.beforeAvatarUpload,"on-success":t.handleSuccess,"list-type":"text"}},[r("el-image",{staticClass:"avatar-image",attrs:{src:t.avatar}},[r("AppLoading",{staticClass:"image-slot",attrs:{slot:"placeholder",size:"large"},slot:"placeholder"}),t._v(" "),r("div",{staticClass:"error-slot",attrs:{slot:"error"},slot:"error"},[r("span",[t._v("点击上传")])])],1)],1)],1),t._v(" "),r("el-form-item",{staticClass:"username-input-item",attrs:{label:"用户名",prop:"username"}},[t.isEditStatus?r("el-input",{model:{value:t.baseInfo.username,callback:function(e){t.$set(t.baseInfo,"username",e)},expression:"baseInfo.username"}}):r("span",[t._v(t._s(t.userInfo.username))])],1),t._v(" "),r("el-form-item",{staticClass:"username-input-item",attrs:{label:"用户邮箱",prop:"email"}},[t.isEditStatus?r("el-input",{model:{value:t.baseInfo.email,callback:function(e){t.$set(t.baseInfo,"email",e)},expression:"baseInfo.email"}}):r("span",[t._v(t._s(t.userInfo.email))])],1),t._v(" "),r("el-form-item",{staticClass:"user-info-input-item",attrs:{label:"个人介绍"}},[t.isEditStatus?r("el-input",{attrs:{rows:6,type:"textarea"},model:{value:t.baseInfo.info,callback:function(e){t.$set(t.baseInfo,"info",e)},expression:"baseInfo.info"}}):r("span",[t._v(t._s(t.userInfo.info))])],1),t._v(" "),r("el-form-item",{attrs:{label:""}},[r("el-button",{attrs:{type:"default",size:"small",plain:""},on:{click:t.toggleEditStatus}},[t._v("\n            "+t._s(t.isEditStatus?"取消":"编辑")+"\n          ")]),t._v(" "),t.isEditStatus?r("el-button",{attrs:{type:"success",size:"small",plain:""},on:{click:t.save}},[t._v("\n            保存\n          ")]):t._e()],1)],1)],1)],1)],1)}),[],!1,null,"242ba87d",null);e.default=component.exports}}]);