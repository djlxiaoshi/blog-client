exports.ids=[19],exports.modules={157:function(t,e,r){var content=r(186);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);var o=r(5).default;t.exports.__inject__=function(t){o("291bfbdc",content,!0,t)}},185:function(t,e,r){"use strict";r.r(e);var o=r(157),n=r.n(o);for(var l in o)"default"!==l&&function(t){r.d(e,t,(function(){return o[t]}))}(l);e.default=n.a},186:function(t,e,r){(e=r(4)(!1)).push([t.i,".author-info-page[data-v-1cfc5132]{padding:20px}.author-info-page[data-v-1cfc5132] .el-upload{text-align:left}.author-info-page .avatar-image[data-v-1cfc5132]{width:100px;height:100px;border:1px solid #e5e5e5}.author-info-page[data-v-1cfc5132] .el-form-item{margin-bottom:15px}.author-info-page[data-v-1cfc5132] .el-form-item__label{padding-bottom:0;font-weight:700}",""]),t.exports=e},203:function(t,e,r){"use strict";r.r(e);var o=r(3),n=r(9),l=r.n(n),f={head:{title:"用户信息",titleTemplate:"%s - DJL箫氏的博客!",htmlAttrs:{lang:"en",amp:!0},meta:[{hid:"description",name:"description",content:"用户信息页面"}]},components:{AppLoading:r(12).a},data:()=>({isEditStatus:!1,rules:{username:[{required:!0,trigger:"blur",message:"请输入用户名"}],email:[{required:!0,trigger:"blur",message:"请输入邮箱"},{trigger:"blur",validator:(t,e,r)=>{e=e.trim();/^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/.test(e)?r():r(new Error("请输入正确的邮箱地址"))}}]},inputStatus:{usernameDisabled:!0,infoDisabled:!0},baseInfo:{}}),computed:{...Object(o.mapState)({userInfo:t=>t.user.userInfo}),avatar(){return this.userInfo?`${this.$globalConfig.IMAGE_ADDRESS}/${this.userInfo.avatarKey}?v=${(new Date).getTime()}`:l.a}},asyncData:({store:t,route:e})=>t.dispatch("user/getUserInfo"),mounted(){this.baseInfo=JSON.parse(JSON.stringify(this.userInfo))},methods:{...Object(o.mapMutations)({setUserInfo:"user/setUserInfo"}),...Object(o.mapActions)({getUserInfo:"user/getUserInfo"}),handleSuccess(t){this.$set(this.userInfo,"avatarKey",t.data.avatarKey),this.setUserInfo(JSON.parse(JSON.stringify(this.userInfo))),this.$notify.success("上传成功")},beforeAvatarUpload(t){const e="image/jpeg"===t.type,r="image/png"===t.type,o=t.size/1024<300;return e||r||this.$notify.error("上传头像图片只能是 JPG或者PNG 格式!"),o||this.$notify.error("上传头像图片大小不能超过 300KB!"),(e||r)&&o},toggleEditStatus(){this.isEditStatus=!this.isEditStatus},save(){this.$refs.form.validate(t=>{t&&this.updateUserInfo().then(t=>{this.setUserInfo(Object.assign({},this.userInfo,t)),this.resetStatus()})})},updateUserInfo(){const{response:t}=this.$http({url:"/user",method:"put",data:{info:this.baseInfo.info,username:this.baseInfo.username,email:this.baseInfo.email},showErrorMsg:!0,showSuccessMsg:!0});return t},resetStatus(){this.isEditStatus=!1}}},c=r(2);var component=Object(c.a)(f,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"author-info-page"},[r("el-row",{attrs:{type:"flex"}},[r("el-col",{attrs:{xs:24,sm:24,md:24,lg:24,xl:24}},[r("el-form",{ref:"form",attrs:{rules:t.rules,model:t.userInfo,"label-width":"80px","label-position":"top"}},[r("el-form-item",{attrs:{label:"头像",prop:"url"}},[r("el-upload",{ref:"upload",staticClass:"upload-avatar-input",attrs:{action:t.$globalConfig.SERVER_ADDRESS+"/api/user/avatar/test","with-credentials":!0,"show-file-list":!1,"before-upload":t.beforeAvatarUpload,"on-success":t.handleSuccess,"list-type":"text"}},[r("el-image",{staticClass:"avatar-image",attrs:{src:t.avatar}},[r("AppLoading",{staticClass:"image-slot",attrs:{slot:"placeholder",size:"large"},slot:"placeholder"})],1)],1)],1),t._v(" "),r("el-form-item",{staticClass:"username-input-item",attrs:{label:"用户名",prop:"username"}},[t.isEditStatus?r("el-input",{model:{value:t.baseInfo.username,callback:function(e){t.$set(t.baseInfo,"username",e)},expression:"baseInfo.username"}}):r("span",[t._v(t._s(t.userInfo.username))])],1),t._v(" "),r("el-form-item",{staticClass:"username-input-item",attrs:{label:"用户邮箱",prop:"email"}},[t.isEditStatus?r("el-input",{model:{value:t.baseInfo.email,callback:function(e){t.$set(t.baseInfo,"email",e)},expression:"baseInfo.email"}}):r("span",[t._v(t._s(t.userInfo.email))])],1),t._v(" "),r("el-form-item",{staticClass:"user-info-input-item",attrs:{label:"个人介绍"}},[t.isEditStatus?r("el-input",{attrs:{rows:6,type:"textarea"},model:{value:t.baseInfo.info,callback:function(e){t.$set(t.baseInfo,"info",e)},expression:"baseInfo.info"}}):r("span",[t._v(t._s(t.userInfo.info))])],1),t._v(" "),r("el-form-item",{attrs:{label:""}},[r("el-button",{attrs:{type:"default",size:"small",plain:""},on:{click:t.toggleEditStatus}},[t._v("\n            "+t._s(t.isEditStatus?"取消":"编辑")+"\n          ")]),t._v(" "),t.isEditStatus?r("el-button",{attrs:{type:"success",size:"small",plain:""},on:{click:t.save}},[t._v("\n            保存\n          ")]):t._e()],1)],1)],1)],1)],1)}),[],!1,(function(t){var e=r(185);e.__inject__&&e.__inject__(t)}),"1cfc5132","3bcc989e");e.default=component.exports}};