{"version":3,"file":"pages/portal/article/_id/Comment.js","sources":["webpack:///./components/common/Empty/index.vue?8b1b","webpack:///./components/common/Editor/Markdown.vue?ce9a","webpack:///./components/common/Empty/empty.png","webpack:///./components/common/Empty/index.vue?43c6","webpack:///./components/common/Empty/index.vue?f719","webpack:///./components/common/Empty/index.vue?b6d9","webpack:///./components/common/Empty/index.vue","webpack:///./components/common/Empty/index.vue?c9a5","webpack:///./components/common/Empty/index.vue?e4db","webpack:///./components/common/Editor/Markdown.vue?298c","webpack:///./components/common/Editor/Markdown.vue?7379","webpack:///./components/common/Editor/Markdown.vue?6c00","webpack:///./components/common/Editor/Markdown.vue","webpack:///./components/common/Editor/Markdown.vue?166f","webpack:///./components/common/Editor/Markdown.vue?72f5","webpack:///./pages/portal/article/_id/Comment.vue?a406","webpack:///./pages/portal/article/_id/Comment.vue?1aea","webpack:///./pages/portal/article/_id/Comment.vue?6e61","webpack:///./pages/portal/article/_id/Comment.vue?61b2","webpack:///./pages/portal/article/_id/Comment.vue","webpack:///./pages/portal/article/_id/Comment.vue?e249","webpack:///./pages/portal/article/_id/Comment.vue?ce20"],"sourcesContent":["// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js??ref--5-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--5-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--5-oneOf-1-3!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=db291270&scoped=true&lang=less&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add CSS to SSR context\nvar add = require(\"!../../../node_modules/vue-style-loader/lib/addStylesServer.js\").default\nmodule.exports.__inject__ = function (context) {\n  add(\"2b552782\", content, true, context)\n};","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js??ref--5-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--5-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--5-oneOf-1-3!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Markdown.vue?vue&type=style&index=0&id=67fecfc8&scoped=true&lang=less&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add CSS to SSR context\nvar add = require(\"!../../../node_modules/vue-style-loader/lib/addStylesServer.js\").default\nmodule.exports.__inject__ = function (context) {\n  add(\"6c6aa55d\", content, true, context)\n};","module.exports = __webpack_public_path__ + \"img/empty.836e20d.png\";","export * from \"-!../../../node_modules/vue-style-loader/index.js??ref--5-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--5-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--5-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--5-oneOf-1-3!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=db291270&scoped=true&lang=less&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".app-empty[data-v-db291270]{height:100%;min-height:200px;display:flex;align-items:center;justify-content:center;flex-direction:column;padding:20px}.app-empty .empty-img[data-v-db291270]{text-align:center}.app-empty .empty-desc[data-v-db291270]{margin-top:20px;text-align:center;font-size:20px;font-weight:700;color:#ddd}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"app-empty\"},[_vm._ssrNode(\"<div class=\\\"empty-img\\\" data-v-db291270><img\"+(_vm._ssrAttr(\"src\",require(\"./empty.png\")))+\" alt data-v-db291270></div> <p class=\\\"empty-desc\\\" data-v-db291270>空空如也</p>\")])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","//\n//\n//\n//\n//\n//\n//\n//\n//\n\nexport default {\n  name: '',\n  props: {\n    isEmpty: {\n      type: Boolean,\n      default: false\n    }\n  }\n};\n","import mod from \"-!../../../node_modules/babel-loader/lib/index.js??ref--2-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/babel-loader/lib/index.js??ref--2-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=db291270&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nfunction injectStyles (context) {\n  \n  var style0 = require(\"./index.vue?vue&type=style&index=0&id=db291270&scoped=true&lang=less&\")\nif (style0.__inject__) style0.__inject__(context)\n\n}\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  \"db291270\",\n  \"4fff016c\"\n  \n)\n\nexport default component.exports","export * from \"-!../../../node_modules/vue-style-loader/index.js??ref--5-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--5-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--5-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--5-oneOf-1-3!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Markdown.vue?vue&type=style&index=0&id=67fecfc8&scoped=true&lang=less&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".markdown-editor[data-v-67fecfc8]{height:100%;display:flex}.markdown-editor[data-v-67fecfc8] .CodeMirror{margin:0 5px;font-size:18px;background-color:#f9f9f5;font-family:\\\"Consolas\\\",\\\"微软雅黑\\\"}.markdown-editor[data-v-67fecfc8] .CodeMirror-activeline-background{background-color:#f1f2ef}@media only screen and (max-width:991px){.markdown-editor .editor-wrap[data-v-67fecfc8]{width:100%!important}}.markdown-editor .textarea[data-v-67fecfc8]{display:none}.markdown-editor .editor-wrap[data-v-67fecfc8],.markdown-editor .preivew-wrap[data-v-67fecfc8]{height:100%;box-sizing:border-box}.markdown-editor .preivew-wrap[data-v-67fecfc8]{padding-left:10px;padding-right:10px;overflow-y:auto}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"markdown-editor\"},[_vm._ssrNode(\"<div class=\\\"editor-wrap\\\"\"+(_vm._ssrStyle(null,{ width: _vm.editMode ? '100%' : '50%' }, { display: (_vm.editMode || _vm.editPreivewMode) ? '' : 'none' }))+\" data-v-67fecfc8><textarea class=\\\"textarea\\\" data-v-67fecfc8>\"+_vm._ssrEscape(_vm._s(_vm.defaultValue))+\"</textarea></div> \"),_vm._ssrNode(\"<div class=\\\"preivew-wrap hidden-sm-and-down\\\"\"+(_vm._ssrStyle(null,{ width: _vm.previewMode ? '100%' : '50%' }, { display: (_vm.previewMode || _vm.editPreivewMode) ? '' : 'none' }))+\" data-v-67fecfc8>\",\"</div>\",[_c('VueShowdown',{staticClass:\"markdown-preview\",attrs:{\"markdown\":_vm.markdwonText,\"options\":_vm.showdownOptions,\"extensions\":[_vm.showdownHighlight],\"flavor\":\"github\"}})],1)],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport { VueShowdown } from 'vue-showdown';\r\nimport showdownHighlight from 'showdown-highlight';\r\nimport _ from 'lodash';\r\n\r\nconst EDIT_PREVIEW_MODE = 1;\r\nconst EDIT_MODE = 2;\r\nconst PREVIEW_MODE = 3;\r\n\r\nexport default {\r\n  components: {\r\n    VueShowdown\r\n  },\r\n  props: {\r\n    viewMode: {\r\n      type: Number,\r\n      default: EDIT_PREVIEW_MODE\r\n    },\r\n    defaultValue: {\r\n      type: String,\r\n      default: ''\r\n    },\r\n    editorConfig: {\r\n      type: Object,\r\n      default: () => ({\r\n        lineNumbers: true,\r\n        height: 100,\r\n        width: '100%'\r\n      })\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      markdwonText: this.defaultValue,\r\n      showdownHighlight,\r\n      showdownOptions: {\r\n        omitExtraWLInCodeBlocks: true,\r\n        ghCodeBlocks: true\r\n      },\r\n      // syncScroll options\r\n      enableSyncScroll: true, // 开启同步滚动\r\n      editorScrolling: false,\r\n      previewerScrolling: false,\r\n      editor: null\r\n    };\r\n  },\r\n  computed: {\r\n    editMode() {\r\n      return this.viewMode === EDIT_MODE;\r\n    },\r\n    previewMode() {\r\n      return this.viewMode === PREVIEW_MODE;\r\n    },\r\n    editPreivewMode() {\r\n      return this.viewMode === EDIT_PREVIEW_MODE;\r\n    }\r\n  },\r\n  watch: {\r\n    defaultValue(value) {\r\n      this.markdwonText = value;\r\n      this.editor.setValue(value);\r\n    }\r\n  },\r\n  mounted() {\r\n    if (process.browser) {\r\n      const CodeMirror = require('codemirror/lib/codemirror.js');\r\n      require('codemirror/addon/selection/active-line.js');\r\n      require('codemirror/addon/edit/closebrackets.js');\r\n      require('codemirror/addon/edit/matchbrackets.js');\r\n      require('codemirror/mode/markdown/markdown.js');\r\n      require('codemirror/lib/codemirror.css');\r\n\r\n      this.editor = CodeMirror.fromTextArea(this.$refs.textarea, {\r\n        value: 'fdsfsd',\r\n        mode: 'markdown',\r\n        lineNumbers: this.editorConfig.lineNumbers,\r\n        lineWrapping: true,\r\n        foldGutter: true,\r\n        tabSize: 2,\r\n        // autofocus: true,\r\n        theme: 'default',\r\n        showCursorWhenSelecting: true,\r\n        matchBrackets: true,\r\n        styleActiveLine: true,\r\n        autoCloseBrackets: true\r\n      });\r\n\r\n      this.editor.setSize(\r\n        this.editorConfig.width || '100%',\r\n        this.editorConfig.height || 100\r\n      );\r\n\r\n      // 内容变化监听\r\n      this.editor.on(\r\n        'change',\r\n        _.debounce((cm) => {\r\n          const content = cm.getValue();\r\n          this.markdwonText = content;\r\n          this.$emit('input', content);\r\n        }, 300)\r\n      );\r\n\r\n      //  同步滚动监听\r\n      //  编辑区滚动\r\n      this.editor.on('scroll', this.syncPreviewerScroll);\r\n    }\r\n  },\r\n  methods: {\r\n    init() {},\r\n    syncPreviewerScroll() {\r\n      if (this.enableSyncScroll) {\r\n        if (this.editorScrolling) {\r\n          this.editorScrolling = false;\r\n          return;\r\n        }\r\n        this.previewerScrolling = true;\r\n        const scrollObj = this.editor.getScrollInfo();\r\n        const percent =\r\n          scrollObj.top / (scrollObj.height - scrollObj.clientHeight);\r\n        const previewer = this.$refs.preview;\r\n        if (previewer) {\r\n          previewer.scrollTop =\r\n            percent * (previewer.scrollHeight - previewer.clientHeight);\r\n        }\r\n      }\r\n    },\r\n    syncEditorScroll() {\r\n      if (this.enableSyncScroll) {\r\n        if (this.previewerScrolling) {\r\n          this.previewerScrolling = false;\r\n          return;\r\n        }\r\n        this.editorScrolling = true;\r\n        const scrollElement = this.$refs.preview;\r\n\r\n        const percent =\r\n          scrollElement.scrollTop /\r\n          (scrollElement.scrollHeight - scrollElement.clientHeight);\r\n        const scrollObj = this.editor.getScrollInfo();\r\n\r\n        const editorTop = percent * (scrollObj.height - scrollObj.clientHeight);\r\n\r\n        this.editor.scrollTo(null, editorTop);\r\n      }\r\n    }\r\n  }\r\n};\r\n","import mod from \"-!../../../node_modules/babel-loader/lib/index.js??ref--2-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Markdown.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/babel-loader/lib/index.js??ref--2-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Markdown.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Markdown.vue?vue&type=template&id=67fecfc8&scoped=true&\"\nimport script from \"./Markdown.vue?vue&type=script&lang=js&\"\nexport * from \"./Markdown.vue?vue&type=script&lang=js&\"\nfunction injectStyles (context) {\n  \n  var style0 = require(\"./Markdown.vue?vue&type=style&index=0&id=67fecfc8&scoped=true&lang=less&\")\nif (style0.__inject__) style0.__inject__(context)\n\n}\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  \"67fecfc8\",\n  \"5e6c4ccd\"\n  \n)\n\nexport default component.exports","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/css-loader/dist/cjs.js??ref--5-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--5-oneOf-1-2!../../../../node_modules/less-loader/dist/cjs.js??ref--5-oneOf-1-3!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Comment.vue?vue&type=style&index=0&id=ad2ff172&scoped=true&lang=less&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add CSS to SSR context\nvar add = require(\"!../../../../node_modules/vue-style-loader/lib/addStylesServer.js\").default\nmodule.exports.__inject__ = function (context) {\n  add(\"39029bdc\", content, true, context)\n};","export * from \"-!../../../../node_modules/vue-style-loader/index.js??ref--5-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--5-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--5-oneOf-1-2!../../../../node_modules/less-loader/dist/cjs.js??ref--5-oneOf-1-3!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Comment.vue?vue&type=style&index=0&id=ad2ff172&scoped=true&lang=less&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".comment-wrap .editor[data-v-ad2ff172] .CodeMirror-wrap{background:#f1f2ef;border:1px solid #ddd}.comment-wrap .edit-wrap .operate-wrap[data-v-ad2ff172]{margin-top:10px;display:flex;justify-content:flex-end}.comment-wrap .separator[data-v-ad2ff172]{border-left:5px solid #ec7259;padding-left:5px;margin:20px auto;font-weight:700}.comment-wrap .comment-list-wrap[data-v-ad2ff172]{padding-left:20px}.comment-wrap .comment-list-wrap .comment-item[data-v-ad2ff172]{list-style:none;padding:20px 0;border-bottom:1px solid #e5e5e5}.comment-wrap .comment-list-wrap .comment-item .comment-desc[data-v-ad2ff172]{font-size:12px}.comment-wrap .comment-list-wrap .comment-item .comment-desc span[data-v-ad2ff172]{margin-right:10px}.comment-wrap .comment-list-wrap .comment-item .comment-content[data-v-ad2ff172]{margin-top:12px;font-size:14px;line-height:1.5;word-break:break-word}.comment-wrap .comment-list-wrap .comment-item .operate-wrap .reply-btn[data-v-ad2ff172]{font-size:12px;color:#409eff;cursor:pointer}.comment-wrap .comment-list-wrap .comment-item .reply-wrap .btn-wrap[data-v-ad2ff172]{display:flex;margin-top:10px;justify-content:flex-end}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{directives:[{name:\"infinite-scroll\",rawName:\"v-infinite-scroll\",value:(_vm.loadMore),expression:\"loadMore\"}],staticClass:\"comment-wrap\",attrs:{\"infinite-scroll-disabled\":\"busy\",\"infinite-scroll-distance\":\"10\"}},[_vm._ssrNode(\"<div class=\\\"edit-wrap\\\" data-v-ad2ff172>\",\"</div>\",[_c('Editor',{ref:\"reply-editor\",staticClass:\"editor\",attrs:{\"viewMode\":2,\"editorConfig\":{\n        height: 100,\n        lineNumbers: false\n      },\"defaultValue\":_vm.defaultValue},on:{\"input\":_vm.onInputChange}}),_vm._ssrNode(\" \"),_vm._ssrNode(\"<div class=\\\"operate-wrap\\\" data-v-ad2ff172>\",\"</div>\",[_c('el-button',{attrs:{\"type\":\"danger\",\"round\":\"\",\"size\":\"mini\"},on:{\"click\":function($event){return _vm.postComment()}}},[_vm._v(\"发布\")]),_vm._ssrNode(\" \"),_c('el-button',{attrs:{\"round\":\"\",\"size\":\"mini\"},on:{\"click\":function($event){return _vm.clear()}}},[_vm._v(\"清空\")])],2)],2),_vm._ssrNode(\" <div class=\\\"separator\\\" data-v-ad2ff172>精彩评论</div> \"),(_vm.comments.length === 0)?_c('Empty'):_c('ul',{staticClass:\"comment-list-wrap\"},_vm._l((_vm.comments),function(comment,index){return _c('li',{key:comment._id,staticClass:\"comment-item\",attrs:{\"id\":(\"comment_id_\" + (comment._id))}},[_c('div',{staticClass:\"comment-desc\"},[_c('span',{staticClass:\"comment-floor\"},[_vm._v(_vm._s(index + 1)+\"楼\")]),_vm._v(\" \"),_c('span',{staticClass:\"comment-user\"},[_vm._v(_vm._s(comment.createUser.username))]),_vm._v(\" \"),(comment.replyUser)?_c('span',[_c('span',[_vm._v(\"回复\")]),_vm._v(\" \"),_c('span',[_vm._v(_vm._s(comment.replyUser.username))])]):_vm._e(),_vm._v(\" \"),_c('span',{staticClass:\"comment-time\"},[_vm._v(_vm._s(_vm.formatTime(comment.createTime)))])]),_vm._v(\" \"),_c('p',{staticClass:\"comment-content\",domProps:{\"innerHTML\":_vm._s(comment.content)}}),_vm._v(\" \"),_c('div',{staticClass:\"operate-wrap\"},[_c('a',{staticClass:\"reply-btn\",on:{\"click\":function($event){return _vm.toggleReplyVisible(true, true, index)}}},[_vm._v(\"回复\")])]),_vm._v(\" \"),(comment._visible)?_c('div',{staticClass:\"reply-wrap\"},[_c('Editor',{staticClass:\"editor\",attrs:{\"viewMode\":2,\"editorConfig\":{\n            height: 100,\n            lineNumbers: false\n          }},on:{\"input\":function($event){return _vm.onInputChange($event, true, index)}}}),_vm._v(\" \"),_c('div',{staticClass:\"btn-wrap\"},[_c('el-button',{ref:\"loadingTarget\",refInFor:true,attrs:{\"type\":\"danger\",\"round\":\"\",\"size\":\"mini\"},on:{\"click\":function($event){return _vm.postComment(true, index)}}},[_vm._v(\"回复\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"round\":\"\",\"size\":\"mini\"},on:{\"click\":function($event){return _vm.toggleReplyVisible(false, true, index)}}},[_vm._v(\"取消\")])],1)],1):_vm._e()])}),0)],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport dayjs from 'dayjs';\r\nimport Editor from '~/components/common/Editor/Markdown.vue';\r\nimport Empty from '@/components/common/Empty';\r\n\r\nconst PAGE_SIZE = 10;\r\n\r\nexport default {\r\n  name: '',\r\n  components: {\r\n    Editor,\r\n    Empty\r\n  },\r\n  data() {\r\n    return {\r\n      visible: false,\r\n      actions: [],\r\n      content: '',\r\n      comments: [],\r\n      commentsTotal: Infinity,\r\n      currentPage: 1,\r\n      pageSize: PAGE_SIZE,\r\n      busy: false,\r\n      defaultValue: ''\r\n    };\r\n  },\r\n  methods: {\r\n    formatTime(timestamp) {\r\n      return dayjs(timestamp).format('YYYY-MM-DD');\r\n    },\r\n    onInputChange(html, isReplyOthers, index) {\r\n      if (isReplyOthers) {\r\n        this.comments[index]._replyContent = html;\r\n      } else {\r\n        this.content = html;\r\n      }\r\n    },\r\n    toggleReplyVisible(status, isReplyOthers, index) {\r\n      if (isReplyOthers) {\r\n        this.$set(this.comments[index], '_visible', status);\r\n      } else {\r\n        this.visible = status;\r\n      }\r\n    },\r\n    getComments(currentPage) {\r\n      const articleId = this.$route.params.id;\r\n      if (articleId) {\r\n        const { response } = this.$http({\r\n          url: `/comments`,\r\n          method: 'get',\r\n          data: {\r\n            pageSize: this.pageSize,\r\n            currentPage,\r\n            articleId\r\n          },\r\n          showSuccessMsg: false,\r\n          showErrorMsg: true\r\n        });\r\n\r\n        return response.then(\r\n          (data) => {\r\n            this.commentsTotal = data.total;\r\n\r\n            this.comments.splice((this.currentPage - 1) * this.pageSize);\r\n            this.comments.push(...data.list);\r\n            // 如果到了下一页，则增加\r\n            if (this.comments.length % this.pageSize === 0) {\r\n              this.currentPage++;\r\n            }\r\n          },\r\n          () => {}\r\n        );\r\n      }\r\n    },\r\n    async loadMore() {\r\n      if (this.comments.length < this.commentsTotal) {\r\n        this.busy = true;\r\n        await this.getComments(this.currentPage);\r\n        this.busy = false;\r\n      }\r\n    },\r\n    postComment(isReplyOthers, index) {\r\n      const articleId = this.$route.params.id;\r\n      if (articleId) {\r\n        // 如果是回复其他评论\r\n        if (isReplyOthers) {\r\n          this.sendRequest({\r\n            articleId,\r\n            replyUser: this.comments[index].createUser._id,\r\n            content: this.comments[index]._replyContent\r\n          });\r\n        } else {\r\n          // 直接评论文章\r\n          this.sendRequest({\r\n            articleId,\r\n            content: this.content\r\n          });\r\n        }\r\n      }\r\n    },\r\n    clear() {\r\n      this.defaultValue = '';\r\n    },\r\n    sendRequest(params) {\r\n      const articleId = this.$route.params.id;\r\n      if (articleId) {\r\n        const { response } = this.$http({\r\n          url: `/comment`,\r\n          method: 'post',\r\n          data: params,\r\n          showSuccessMsg: true,\r\n          showErrorMsg: true\r\n        });\r\n\r\n        response.then(\r\n          (comment) => {\r\n            this.clear();\r\n            this.getComments(this.currentPage);\r\n          },\r\n          () => {}\r\n        );\r\n      }\r\n    }\r\n  }\r\n};\r\n","import mod from \"-!../../../../node_modules/babel-loader/lib/index.js??ref--2-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Comment.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/babel-loader/lib/index.js??ref--2-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Comment.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Comment.vue?vue&type=template&id=ad2ff172&scoped=true&\"\nimport script from \"./Comment.vue?vue&type=script&lang=js&\"\nexport * from \"./Comment.vue?vue&type=script&lang=js&\"\nfunction injectStyles (context) {\n  \n  var style0 = require(\"./Comment.vue?vue&type=style&index=0&id=ad2ff172&scoped=true&lang=less&\")\nif (style0.__inject__) style0.__inject__(context)\n\n}\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  \"ad2ff172\",\n  \"1cbf13a2\"\n  \n)\n\nexport default component.exports"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;ACVA;;;;;;;;ACAA;AAAA;AAAA;AAAA;;;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;ACNA;AACA;AACA;;;;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAFA;AADA;AAFA;;ACVA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACvBA;AAAA;AAAA;AAAA;;;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;ACNA;AACA;AACA;;;;;;;;;;;;;;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AADA;AAGA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AACA;AACA;AAHA;AAFA;AATA;AACA;AAiBA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAAA;AACA;AACA;AACA;AAXA;AAaA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAVA;AAWA;AACA;AACA;AACA;AACA;AACA;AALA;AACA;AAKA;AACA,iBAyCA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAEA;AACA;AAAA;AACA;AAEA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAEA;AAGA;AAEA;AAEA;AACA;AACA;AACA;AAtCA;AAlGA;;AC1CA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACVA;AAAA;AAAA;AAAA;;;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AAFA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AATA;AAWA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAHA;AAKA;AACA;AATA;AAYA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAHA;AAKA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AALA;AAQA;AAEA;AACA;AACA;AAGA;AACA;AACA;AAjGA;AAnBA;;ACzFA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}